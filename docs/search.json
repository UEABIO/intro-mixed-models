[{"path":"index.html","id":"overview","chapter":"Overview","heading":"Overview","text":"Data often complex messy.can different grouping factors like collect data, etc. Sample sizes may also leave something desired, especially try fit complicated models many parameters. top , data points might truly independent. instance, might structure data.mixed models developed, deal messy data allow us use data, even low sample sizes, structured data many covariates fit. top , mixed models allow us save degrees freedom compared running standard linear models! Sounds good.cover basics linear mixed models, use responsibly interepret findings effectively.trying “extend” linear model, fear : generalised linear mixed effects models, .","code":""},{"path":"index.html","id":"terminology","chapter":"Overview","heading":"0.1 Terminology","text":"Mixed-effects models sometime referred hierarchical models, multi-level models, random effects models, mixed-models. Regardless confusing vocabulary, ’s worth knowing terms may used mean similar models.Random effects important part mixed-effects models. Random effects capture variations come grouping clustering data. used mixed models, combine fixed effects (relationships variables) random effects. approach helps us account correlations dependencies within groups, making models realistic.nature, often see hierarchical structures, streams within watershed species within family. Random effects can useful situations others observations tend clustered. using random effects, can improve ability model system accurately.main purpose applying random effects mixed models capture realistic patterns uncertainties data. example, can account correlations arise multiple observations within group observations lack complete independence.sum , random effects mixed models help us deal situations observations independent. allow us capture complexities dependencies within groups, improving accuracy statistical models.","code":""},{"path":"index.html","id":"variance","chapter":"Overview","heading":"0.1.1 Variance","text":"understand mixed- random effects models, need understand random effects understand random effects, need understand variance. often need think variance system showing model model handles variance know . Historically variance seen noise distraction, objective remove minimize possible variance. Variance often seen nuisance parameter. However, can information variance. Variance ubiquitous, understanding part system holds proportions variance can benefit understanding systems seek model. familiar residual variance linear models, might residual variance better attributed within group? group?","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"introduction-to-r-and-rstudio","chapter":"1 Introduction to R and RStudio","heading":"1 Introduction to R and RStudio","text":"R name programming language learn course.R name programming language learn course.RStudio convenient interface using throughout course order learn organise data, produce accurate data analyses & data visualisations.RStudio convenient interface using throughout course order learn organise data, produce accurate data analyses & data visualisations.R programming language write code , RStudio Integrated Development Environment (IDE) makes working R easier. Think knowing English using plain text editor like NotePad write book versus using word processor like Microsoft Word. , look good much harder without things like spell-checking formatting. similar way, can use R without R Studio recommend . key thing remember although work using RStudio course, actually using two pieces software means time--time, may separate updates.R RStudio can downloaded free onto personal computers(see Appendices), convenience use classroom space RStudio Cloud.RStudio Cloud cloud-based service can log remotely hosted servers host data analysis projects.advantage using RStudio Cloud extra packages functions need course already installed. can log-workspace computer long internet connection remember username password. can also \"visit\" projects help get stuck, hosted RStudio Cloud.Eventually may also add extra tools like GitHub RMarkdown data reproducibility, literate collaborative programming.end course hope tools confidently analyze real data, make informative beautiful data visuals, able analyze lots different types data.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"using-rstudio-cloud","chapter":"1 Introduction to R and RStudio","heading":"1.1 Using RStudio Cloud","text":"sessions run cloud-based software. make free account, join Workspace.signed - see two spaces:workspace - personal use (20hrs/month)workspace - personal use (20hrs/month)shared classroom - educational licence (limit)shared classroom - educational licence (limit)Make sure working classroom workspace - can distribute project work 'visit' projects needed.RStudio Cloud works exactly way RStudio, means download software. can access hosted cloud server projects browser connection (Chrome works best), computer.good reference guide RStudio Cloud","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"getting-to-know-rstudio","chapter":"1 Introduction to R and RStudio","heading":"1.2 Getting to know RStudio","text":"R Studio console can try code (appearing bottom left window), script editor (top left), window showing functions objects created \"Environment\" tab (top right window figure), window shows plots, files packages, help documentation (bottom right).\nFigure 1.1: RStudio interface\nlearn use features included R Studio throughout course, however, highly recommend watching RStudio Essentials 1 point.video lasts ~30 minutes gives tour main parts R Studio.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"consoles-vs.-scripts","chapter":"1 Introduction to R and RStudio","heading":"1.2.1 Consoles vs. scripts","text":"script window place enter run code easily edited saved future use. Usually Script Window shown top left RStudio. window shown, visible open previously saved R script, create new R Script. create new R Script clicking File > New File > R Script RStudio menu bar.script window place enter run code easily edited saved future use. Usually Script Window shown top left RStudio. window shown, visible open previously saved R script, create new R Script. create new R Script clicking File > New File > R Script RStudio menu bar.execute code R script, can either highlight code click Run, can highlight code press CTRL + Enter keyboard.execute code R script, can either highlight code click Run, can highlight code press CTRL + Enter keyboard.console: can enter code directly Console Window click Enter. commands run shown History Window top right RStudio. Though much difficult keep track work way.console: can enter code directly Console Window click Enter. commands run shown History Window top right RStudio. Though much difficult keep track work way.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"environment","chapter":"1 Introduction to R and RStudio","heading":"1.2.2 Environment","text":"Environment tab (top right) allows see objects workspace. create variables data frames, visual listing everything current workspace. start new project completely empty.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"plots-files-packages-help","chapter":"1 Introduction to R and RStudio","heading":"1.2.3 Plots, files, packages, help","text":"Plots - Plots panel, shows plots. buttons opening plot separate window exporting plot pdf jpeg (though can also code.)Plots - Plots panel, shows plots. buttons opening plot separate window exporting plot pdf jpeg (though can also code.)Files - files panel gives access file directory hard drive.Files - files panel gives access file directory hard drive.Packages - Shows list R packages installed harddrive indicates whether currently loaded. Packages loaded current session checked installed yet loaded unchecked. discuss packages later.Packages - Shows list R packages installed harddrive indicates whether currently loaded. Packages loaded current session checked installed yet loaded unchecked. discuss packages later.Help - Help menu R functions. can either type name function search window, use code search function nameHelp - Help menu R functions. can either type name function search window, use code search function name\nFigure 1.2: RStudio interface labelled\n","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"make-rstudio-your-own","chapter":"1 Introduction to R and RStudio","heading":"1.2.4 Make RStudio your own","text":"can personalise RStudio GUI much like.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"get-help","chapter":"1 Introduction to R and RStudio","heading":"1.3 Get Help!","text":"lot sources information using R . helpful places get help issue, just learn moreThe R help system - type help() put name package function querying inside bracketsThe R help system - type help() put name package function querying inside bracketsVignettes - type browseVignettes() console hit Enter, list available vignettes packages displayedVignettes - type browseVignettes() console hit Enter, list available vignettes packages displayedCheat Sheets - available RStudio.com. common packages associate cheat sheet covering basics use . Download/bookmark ones use commonly ggplot2, data transformation dplyr, Data tidying tidyr & Data import.Cheat Sheets - available RStudio.com. common packages associate cheat sheet covering basics use . Download/bookmark ones use commonly ggplot2, data transformation dplyr, Data tidying tidyr & Data import.Google - use Google constantly, continually forget even basic tasks. want remind round number, might type something like R round number - using particular package include search term wellGoogle - use Google constantly, continually forget even basic tasks. want remind round number, might type something like R round number - using particular package include search term wellAsk help - stuck, getting error message, think next, ask someone. , classmate. important show code, include error message. \"work\" helpful. \"code, data using, want X, problem get.\"Ask help - stuck, getting error message, think next, ask someone. , classmate. important show code, include error message. \"work\" helpful. \"code, data using, want X, problem get.\"\nmay daunting send code someone help.\n\nnatural common feel apprehensive, think \ncode really bad. still feel ! learn share\nmistakes, eventually find funny look back\nearly mistakes, laugh mistakes still\noccasionally make!\n","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"get-started","chapter":"1 Introduction to R and RStudio","heading":"1.4 Get Started","text":"Go RStudio Cloud enter Project labelled Day One - clone project provide project workspace.Follow instructions get used R command line, R works language.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"your-first-r-command","chapter":"1 Introduction to R and RStudio","heading":"1.5 Your first R command","text":"RStudio pane, navigate console (bottom left) type copy appear >Hit Enter keyboard.answer get?first line shows request made R, next line R's responseYou type > symbol: just R command prompt part actual command.important understand output formatted. Obviously, correct answer sum 10 + 20 30, surprisingly R printed part response. also printed [1] part, probably make lot sense right now. going see lot. can think [1] 30 R saying \"answer 1st question asked 30\".","code":"\n10 + 20\n30"},{"path":"introduction-to-r-and-rstudio.html","id":"operators","chapter":"1 Introduction to R and RStudio","heading":"1.5.1 Operators","text":"two types operators consider","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"arithmetic-operators","chapter":"1 Introduction to R and RStudio","heading":"1.5.1.1 Arithmetic Operators","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"logical-operators","chapter":"1 Introduction to R and RStudio","heading":"1.5.1.2 Logical Operators","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"typos","chapter":"1 Introduction to R and RStudio","heading":"1.5.2 Typos","text":"\ngo talk types calculations can\nR, ’s things want point . first\nthing , R good software, ’s still software. ’s\npretty stupid, ’s stupid can’t handle typos. takes\nfaith meant type exactly type.\nSuppose forget hit shift key trying type +, result command ended 10 = 20 rather 10 + 20. Try replicate error message:Error 10 = 20 : invalid (do_set) left-hand side assignmentWhat's happened R attempted interpret 10 = 20 command, spits error message command make sense .human looks , looks keyboard sees + = key, pretty obvious command typo. R know , gets upset.Even subtle fact typos produce errors , happen correspond \"well-formed\" R commands. instance, suppose forget hit shift key trying type 10 + 20, also managed press key next one meant . resulting typo produce command 10 - 20. Clearly, R way knowing meant add 20 10, subtract 20 10, happens time :case, R produces right answer, wrong question.","code":"\n10 = 20\n10 - 20## [1] -10"},{"path":"introduction-to-r-and-rstudio.html","id":"more-simple-arithmetic","chapter":"1 Introduction to R and RStudio","heading":"1.5.3 More simple arithmetic","text":"One best ways get know R play , pretty difficult break worry much. Type whatever want console see happens.last line console looks like thisand blinking cursor next plus sign. means R still waiting finish. \"thinks\" still typing command, tried execute yet. words, plus sign actually another command prompt. different usual one (.e., > symbol) remind R going \"add\" whatever type now typed last time. example, type 20 hit enter, finishes command:Alternatively hit escape key, R forget trying return blank line.","code":"> 10+\n+ > 10 +\n+ 20\n[1] 30"},{"path":"introduction-to-r-and-rstudio.html","id":"try-some-simple-maths","chapter":"1 Introduction to R and RStudio","heading":"1.5.4 Try some simple maths","text":"Raise number power anotherAs sure everyone probably remember moment read , act multiplying number \\(x\\) \\(n\\) times called \"raising \\(x\\) \\(n\\)-th power\". Mathematically, written \\(x^n\\). values \\(n\\) special names: particular \\(x^2\\) called \\(x\\)-squared, \\(x^3\\) called \\(x\\)-cubed. , 4th power 5 calculated like :\\[5^4 = 5 \\times 5 \\times 5 \\times 5 \\]","code":"\n1+7\n13-10\n4*6\n12/3\n5^4"},{"path":"introduction-to-r-and-rstudio.html","id":"perform-some-combos","chapter":"1 Introduction to R and RStudio","heading":"1.5.5 Perform some combos","text":"Perform mathematical combos, noting order R performs calculations standard one., first calculate things inside Brackets (), calculate Orders (exponents) ^, Division / Multiplication *, Addition + Subtraction -.Notice different outputs two commands.Similarly want raise number fraction, need surround fraction parentheses ()first one calculates 16 raised power 1, divided answer two. second one raises 16 power half. big difference output.\ncursor console, can press arrow see\nprevious commands.\n\ncan run , edit . Later look \nscripts, essential way re-use, store edit commands.\n","code":"\n3^2-5/2\n(3^2-5)/2\n16^1/2\n16^(1/2)"},{"path":"introduction-to-r-and-rstudio.html","id":"true-or-false-data","chapter":"1 Introduction to R and RStudio","heading":"1.6 \"TRUE or FALSE\" data","text":"Time make sidebar onto another kind data. Many concepts programming rely idea logical value. logical value assertion whether something true false. implemented R pretty straightforward way. two logical values, namely TRUE FALSE. Despite simplicity, logical values useful things. see work.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"assessing-mathematical-truths","chapter":"1 Introduction to R and RStudio","heading":"1.6.1 Assessing mathematical truths","text":"George Orwell's classic book 1984, one slogans used totalitarian Party \"two plus two equals five\", idea political domination human freedom becomes complete possible subvert even basic truths.R!R subverted. rather firm opinions topic true, least regards basic mathematics. ask calculate 2 + 2, always gives answer, 5:course, far R just calculations. asked explicitly assert \\(2+2 = 4\\) true statement. want R make explicit judgement, can use command like :TRUEWhat done use equality operator, ==, force R make \"true false\" judgement.\ndifferent operator assignment operator\n= saw previously.\n\ncommon typo people make trying write logical commands\nR (languages, since “= versus\n==” distinction important programming languages)\naccidentally type = really mean\n==.\nOkay, see R thinks Party slogan:Take Big Brother! Anyway, worth look happens try force R believe two plus two five making assignment statement like 2 + 2 = 5 2 + 2 <- 5. , happens:R like much. recognises 2 + 2 variable (\"non-language object\" part saying), let try \"reassign\" . R pretty flexible, actually let quite remarkable things redefine parts R , just basic, primitive truths refuses give . change laws addition, change definition number 2.probably best.","code":"\n2 + 2## [1] 4\n2 + 2 == 4\n2+2 == 5## [1] FALSE\n2 + 2 = 5Error in 2 + 2 = 5 : target of assignment expands to non-language object"},{"path":"introduction-to-r-and-rstudio.html","id":"storing-outputs","chapter":"1 Introduction to R and RStudio","heading":"1.7 Storing outputs","text":"simple questions like ones happy just see answer, questions often complex . need take multiple steps, benefit able store answers recall use later steps. simple can assign outputs name:literally means please assign value 1+2 name . use assignment operator <- make assignment.\nNote shortcut key <- Alt + - (Windows) Option + -\n(Mac)\nperform action able two thingsYou able see top right-hand pane Environment tab now object called value 3.\nFigure 1.3: object now visible withe value 3 Environment Pane\nable look typing Console pressing EnterYou able look typing Console pressing EnterNote see outcome functions type object R console hit EnterNote see outcome functions type object R console hit EnterYou can now call object time R session perform calculations .happens assign value named object already exists R environment??? exampleThe value now 10.see previous assignment lost, gone forever replaced new value.can assign lots things objects, use calculations build objects.\nRemember: now change value b, value c \nchange.\n\nObjects totally independent \nmade.\n\nOverwriting objects new values means old value lost.\nvalue c?[1] 15When c created product b values 10 15 respectively.\nre-ran command c <- + b changing value b get value 17.Look environment tab - see starting fill now!\nRStudio default save objects memory close\nsession.\n\nnext time logon. might seem nice\nable close things pick left , \nactually quite dangerous. ’s messy, can cause lots problems\nwork scripts later, don’t !\n\nstop RStudio saving objects default go Tools >\nProject Options option change “Save workspace .RData exit” \n“” “Never”.\n\nInstead going learn use scripts quickly re-run\nanalyses working .\n","code":"\na <- 1+2\na\n3\n2 * a\n6\na <- 10\na\nb <- 5\nc <- a + b\nb <- 7\nb\nc"},{"path":"introduction-to-r-and-rstudio.html","id":"choosing-names","chapter":"1 Introduction to R and RStudio","heading":"1.7.1 Choosing names","text":"Use informative variable names. general rule, using meaningful names like orange apple preferred arbitrary ones like variable1 variable2. Otherwise hard remember contents different variables actually .Use informative variable names. general rule, using meaningful names like orange apple preferred arbitrary ones like variable1 variable2. Otherwise hard remember contents different variables actually .Use short variable names. Typing pain -one likes . much prefer use name like apple name like pink_lady_apple.Use short variable names. Typing pain -one likes . much prefer use name like apple name like pink_lady_apple.Use one conventional naming styles multi-word variable names. R lets use certain things legal names. Legal names must start letter number, can followed sequence letters, numbers, ., _. R like using spaces. Upper lower case names allowed, R case sensitive Apple apple different.Use one conventional naming styles multi-word variable names. R lets use certain things legal names. Legal names must start letter number, can followed sequence letters, numbers, ., _. R like using spaces. Upper lower case names allowed, R case sensitive Apple apple different.favourite naming convention snake_case short, lower case , spaces words separated _. easy read easy remember.favourite naming convention snake_case short, lower case , spaces words separated _. easy read easy remember.\nFigure 1.4: courtesy Allison Horst\n","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"error","chapter":"1 Introduction to R and RStudio","heading":"1.8 Error","text":"Things go wrong eventually, always ...R pedantic, even smallest typo can result failure typos impossilbe avoid. make mistakes. One type mistake make error. code fails run. common causes error :typostyposmissing commasmissing commasmissing bracketsmissing bracketsThere's nothing wrong making lots errors. trick panic get frustrated, read error message script carefully start debug...... sometimes need walk away come back later!\nTry typing command help() R console, \nopen new tab bottom right.\n\nPut function package brackets get help \nspecific topic\n\nFigure 1.5: courtesy Allison Horst\n","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"functions","chapter":"1 Introduction to R and RStudio","heading":"1.9 Functions","text":"Functions tools R. one helps us different task.Take example function use round number certain number digits - function called roundHere's example:start command function name round. name followed parentheses (). Within place arguments function, separated comma.arguments:x = 2.4326782647 (number like round)x = 2.4326782647 (number like round)digits = 2 (number decimal places like round )digits = 2 (number decimal places like round )Arguments inputs give function. arguments form name = value name specifies argument, value providing define input. first argument x number like round, value 2.4326782647. second argument digits like number rounded specify 2. limit many arguments function .\nCopy paste following code console.\nhelp documentation round()appear bottom right help panel. usage section, see round()takes following form:arguments section, explanations arguments. xis number vector wish round values. digits number decimal places used. description can see value supplied digits default 0 whole number rounding.Read 'Details' section find happens rounding last digit 5.try example just change required argument digits\nCopy paste following code console.\nNow can change additional arguments produce different set numbers.time R still rounded number, done set number 'decimal places'.Always remember use help documentation help understand arguments function requires.","code":"\nround(x  = 2.4326782647, digits = 2)\nhelp(round)\nround(x, digits = 0)\nround(x  = 2.4326782647)## [1] 2\nround(x  = 2.4326782647, digits = 2)## [1] 2.43"},{"path":"introduction-to-r-and-rstudio.html","id":"storing-the-output-of-functions","chapter":"1 Introduction to R and RStudio","heading":"1.9.1 Storing the output of functions","text":"need answer function later calculation. answer use assignment operator <-.example assign values two R objects can call inside R function though putting numbers directly.\nCopy paste following code console.\nvalue assigned R object rounded_number ?[1] 2.433","code":"\nnumber_of_digits <- 3\n\nmy_number <- 2.4326782647\n\nrounded_number <- round(x  = my_number, \n                        digits = number_of_digits)"},{"path":"introduction-to-r-and-rstudio.html","id":"more-fun-with-functions","chapter":"1 Introduction to R and RStudio","heading":"1.9.2 More fun with functions","text":"Copy paste :Looks like even give names arguments function still work. works function round expects us give number value first, argument rounding digits second. assumes know expected ordering within function, might case functions use lot. give arguments proper names can actually introduce order want.Try :gives different answer\nRemember naming arguments overrides position defaults\nknow argument orders defaults? Well get know lot functions work practice, can also use help() .","code":"\nround(2.4326782647, 2)\nround(digits = 2, x  = 2.4326782647)\nround(2, 2.4326782647)"},{"path":"introduction-to-r-and-rstudio.html","id":"packages","chapter":"1 Introduction to R and RStudio","heading":"1.10 Packages","text":"install R access range functions including options data wrangling statistical analysis. functions included default installation typically referred Base R useful cheat sheet shows many Base R functions hereHowever, power R extendable open source - anyone can create new package extends functions R.R package container various things including functions data. make easy complicated protocols using custom-built functions. Later see can write simple functions. Packages lot like new apps extending functionality phone can .RStudio Cloud already installed several add-packages, need use simple function library() load packages workspace. complete access custom functions contain.\nCopy paste following code console.\nggplot2 - one popular packages use R. \"grammar graphics\" packages dedicated making data visualisations, contains lots dedicated functions .ggplot2 - one popular packages use R. \"grammar graphics\" packages dedicated making data visualisations, contains lots dedicated functions .palmerpenguins - good example data-heavy package, contains functions, instead datasets can use.palmerpenguins - good example data-heavy package, contains functions, instead datasets can use.\ncommon source errors call function part \npackage forgetting load package.\n\nR says something like “Error ”function-name”: find X”\nlikely function misspelled package containing\nfunction hasn’t loaded.\n","code":"\nlibrary(ggplot2)\nlibrary(palmerpenguins)"},{"path":"introduction-to-r-and-rstudio.html","id":"my-first-data-visualisation","chapter":"1 Introduction to R and RStudio","heading":"1.11 My first data visualisation","text":"run first data visualisation using functions data now loaded - produces plot using functions ggplot2 package data palmerpenguins package.Data visualisation core part data science, generating insights data - spend lot time course working data visualisations.Today use simple functions produce figure. specify data source, variables used x y axis type visual object produce, colouring species.\nCopy paste following code console.\n\nmay noticed R gave warning. big\nscary error, R wants aware something.\n\ncase two observations missing data \n(either bill length bill depth), couldn’t plotted.\n\ngood thing take note warnings errors - \nprovide useful information.\ncommand can also written , longer style new line argument function. style can easier read, makes easier write comments #. Copy longer command console hit Enter.Note R ignores anything comes # line code - means can add notes work.","code":"\nggplot(data = penguins,aes(x = bill_length_mm, y = bill_depth_mm)) + geom_point(aes(colour=species)) \nggplot(data = penguins, # calls ggplot function, data is penguins\n       aes(x = bill_length_mm, # sets x axis as bill length\n           y = bill_depth_mm)) + # sets y axis value as bill depth\n    geom_point(aes(colour=species)) # plot points coloured by penguin species"},{"path":"introduction-to-r-and-rstudio.html","id":"writing-scripts","chapter":"1 Introduction to R and RStudio","heading":"1.12 Writing scripts","text":"now typing words directly Console. fine short/simple calculations - soon complex, multi-step process becomes time consuming, error-prone boring. Scripts document containing commands (order want run), repeatable, shareable, annotated records done. short incredibly useful - big step towards open reproducible research.\nFigure 1.6: RStudio interface - top left script, botto left console\nopen pane top-left RStudio tab name Untitled1.\nscript way organising R commands, sequence,\nproduce desired output.\n\nwrite script, nothing happens tell RUN,\nsee commands appearing console.\n\nMake sure include commands need complete \nanalysis, correct order.\n","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"organising-scripts","chapter":"1 Introduction to R and RStudio","heading":"1.12.1 Organising scripts","text":"Scripts work best well organised - well documented. Simple tricks consistent organisation can make work easier read reproduced others.bookmark Tidyverse Style Guide, opinionated way organising scripts code consistent style, maximises readability. Later course use benchmark assessing code writing.Annotating instructions provides others insights . vital aspect robust reproducible workflow. come back script, one week, one month one year now often wonder command . , useful make notes , useful case anyone else ever read script. Make comments helpful humans read.already seen signal comment # key. Everything line # ignored R treated command. also see marked different colour script.\nPut following comment script line 1.\ncan also use # produce Headers different levels, follow commented lines - = shown figure .\n(#fig:script outline)R script document outline. Push button five horizontal lines reveal R recognises headers subheaders\n","code":"\n# I really love R"},{"path":"introduction-to-r-and-rstudio.html","id":"loading-packages","chapter":"1 Introduction to R and RStudio","heading":"1.12.2 Loading packages","text":"use functions package script must loaded call functions data contain. sensible place put library calls packages top script. now,\nAdd commandslibrary(ggplot2) \nlibrary(palmerpenguins) script.\n\nThink organise script using image \nguide\n\nPut comment next package explaining “Hint\nuse help() function”.\n\nUse document outline button help organise script.\n\nR Studio interpret Unicode present images can\ninclude scripts. ’s necessary, fun way help\norganise scripts.\n","code":"\n# I really love R\n# _______________----\n\n# 📦 PACKAGES ----\n\nlibrary(ggplot2) # create elegant data visualisations\nlibrary(palmerpenguins) # Palmer Archipelago Penguin Data\n\n# ______________----"},{"path":"introduction-to-r-and-rstudio.html","id":"adding-more-code","chapter":"1 Introduction to R and RStudio","heading":"1.12.3 Adding more code","text":"\nAdd code script, underneath sections \nalready \nsimilar code ran earlier, preceded plot_1 <-","code":"\n# DATA VISUAL ----\n\nplot_1 <- ggplot(data = penguins, # calls ggplot function, data is penguins\n           aes(x = bill_length_mm, # sets x axis as bill length\n               y = bill_depth_mm)) + # sets y axis value as bill depth\n          geom_point(aes(colour=species)) # geometric to plot\n\n# ______________----"},{"path":"introduction-to-r-and-rstudio.html","id":"running-your-script","chapter":"1 Introduction to R and RStudio","heading":"1.12.4 Running your script","text":"run commands script, need get Console. select copy/paste Console. couple faster shortcuts.Hit Run button top right script pane. Pressing run line code cursor sitting .Hit Run button top right script pane. Pressing run line code cursor sitting .Pressing Ctrl+Enter thing hitting Run buttonPressing Ctrl+Enter thing hitting Run buttonIf want run whole script one go press Ctrl+either click Run press Ctrl+EnterIf want run whole script one go press Ctrl+either click Run press Ctrl+EnterTry now.notice unlike making previous data visuals, immediately see graph, assigned output functions R object, instead default action R print output. Check \"Environment\" tab - able see plot_1 .see new plot made type plot_1 R console. add underneath script run !","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"making-an-output","chapter":"1 Introduction to R and RStudio","heading":"1.12.5 Making an output","text":"next trick make script outputs file. Underneath lines code generate figure add new function ggsave(). re-run script. find function (arguments contains), type help(ggsave) console.Check Files tab RStudio Cloud, now new file workspace called \"2022_10_01_5023Y_workshop_1_penguin_scatterplot.png\".Wow mouthful! made long filename? Well contains information help know future.DateDateModule codeModule codeShort description file contentsShort description file contents\nimportant naming conventions files.\n\nEverything . file extension information\ninforming computer process contents file.\n.png stands “Portable Graphics Format”, means\ndata uncompressed image format.\n\nEverything . humans, good idea\nmake sure naming convention.\n\nAvoid periods, spaces slashes, instead use YYYYMMDD \nunderscores\n\ne.g. YYYYMMDD_short_image_description.fileextension\n","code":"\n# OUTPUT TO FILE ----\n\nggsave(filename = \"2022_10_01_5023Y_workshop_1_penguin_scatterplot.png\", \n       plot = plot_1, \n       dpi = 300, \n       width = 6, \n       height = 6)\n# _________________----"},{"path":"introduction-to-r-and-rstudio.html","id":"saving-your-script","chapter":"1 Introduction to R and RStudio","heading":"1.12.6 Saving your script","text":"script now contains code comments first workshop. need save .Alongside data, script precious part analysis. need save anything else, outputs etc. script can always used generate everything . Note colour script - name changes colour unsaved changes. Press Save button go File > Save . Give File sensible name like \"YYYYMMDD_5023Y_workshop_1_simple_commands\" bottom right pane Files now able see saved script, saved .R file extension indicating R Script.now safely quit R, log next time project, script waiting .","code":"\n# I really love R\n# _______________----\n\n# 📦 PACKAGES ----\n\nlibrary(ggplot2) # create elegant data visualisations\nlibrary(palmerpenguins) # Palmer Archipelago Penguin Data\n\n# ________________----\n# DATA VISUAL ----\n\nplot_1 <- ggplot(data = penguins, # calls ggplot function, data is penguins\n           aes(x = bill_length_mm, # sets x axis as bill length\n               y = bill_depth_mm)) + # sets y axis value as bill depth\n          geom_point(aes(colour=species)) # geometric to plot\n\n# ______________----\n\n# OUTPUT TO FILE ----\n\nggsave(filename = \"2022_10_01_5023Y_workshop_1_penguin_scatterplot.png\", \n       plot = plot_1, \n       dpi = 300, \n       width = 6, \n       height = 6)\n# _________________----"},{"path":"introduction-to-r-and-rstudio.html","id":"quitting","chapter":"1 Introduction to R and RStudio","heading":"1.13 Quitting","text":"Make sure saved changes R script - need make sure done!Make sure saved changes R script - need make sure done!want take look script let knowIf want take look script let knowIf spotted mistakes errors let knowIf spotted mistakes errors let knowClose RStudio Cloud BrowserClose RStudio Cloud BrowserComplete week's short quiz!Complete week's short quiz!","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"activity-1","chapter":"1 Introduction to R and RStudio","heading":"1.14 Activity 1","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"complete-this-quiz","chapter":"1 Introduction to R and RStudio","heading":"1.14.1 Complete this Quiz","text":"get correct answer, answer box turn green. Sometimes work Internet Explorer Edge sure use Chrome Firefox.Question 1. output 5^4Question 2. answer get type 2+2 = 4 R console?TRUEFALSEErrorIf wanted R make judgement must use == = otherwise get Error messageQuestion 3. symbol use want assign value output function R objectQuestion 4. value ran following commands?Question 5. variable naming conventions written correctly?snake_casecamelCaseScreaming_Snake_Casekebab-caseQuestion 6. type R console want help round() function?Question 7. statements function arguments trueArguments inputs give functionValues R arguments must always defined userNaming arguments supersedes position functionThere limit number arguments function haveQuestion 8. Evaluate statement \"R Package can contain code functions, data, .\"TRUEFALSE","code":"\na <-  12*2\n\na <- 5"},{"path":"r-basics.html","id":"r-basics","chapter":"2 R Basics","heading":"2 R Basics","text":"load packages use function library(). Typically start analysis script loading packages need.tidyverse opinionated collection R packages designed data science. packages share underlying design philosophy, grammar, data structures. means functions across tidyverse designed work together make process data science easier.","code":""},{"path":"r-basics.html","id":"using-packages","chapter":"2 R Basics","heading":"2.1 Using packages","text":"Run code load tidyverse package. can regardless whether using computer cloud.get looks like error message - . just R telling done. read gives full list packages made available . One look familiar last week?ggplot2tibbletidyrdplyrNow loaded tidyverse package can use functions contains remember, need run library() function every time start R.order use package, must first install . following code installs package tidyverse, package use frequently.working computer, use code install tidyverse.need install package , however, time start R need load packages want use, similar way need install app phone , need open every time want use .\nget error message says something like “WARNING: Rtools\nrequired build R packages” may need download install \nextra bit software called Rtools.\n","code":"\nlibrary(tidyverse)\ninstall.packages(\"tidyverse\")"},{"path":"r-basics.html","id":"package-updates","chapter":"2 R Basics","heading":"2.2 Package updates","text":"addition updates R R Studio, creators packages also sometimes update code. can add functions package, can fix errors. One thing avoid unintentionally updating installed package. run install.packages() always install latest version package overwrite older versions may installed. Sometimes problem, however, sometimes find update means code longer works package changed substantially. possible revert back older version package try avoid anyway.\navoid accidentally overwriting package later version, \nnever include install.packages() \nanalysis scripts case , someone else runs code \nmistake. Remember, server already packages \nneed course need install packages \nusing machine.\n","code":""},{"path":"r-basics.html","id":"package-conflicts","chapter":"2 R Basics","heading":"2.3 Package conflicts","text":"thousands different R packages even functions. Unfortunately, sometimes different packages function names. example, packages dplyr MASS function named select(). load packages, R produce warning telling conflict.case, R telling function select() dplyr package hidden ('masked') another function name. try use select(), R use function package loaded recently - case use function MASS.want specify package want use particular function can use code format package::function, example:\nget naming conflicts?\n\nR open source software. Anyone can write \nsubmit useful R packages. result impossible make sure \nNEVER functions identical names.\n","code":"\nlibrary(dplyr)\nlibrary(MASS)package �dplyr� was built under R version 3.6.3\nAttaching package: �dplyr�\n\nThe following objects are masked from �package:stats�:\n\n    filter, lag\n\nThe following objects are masked from �package:base�:\n\n    intersect, setdiff, setequal, union\n\n\nAttaching package: �MASS�\n\nThe following object is masked from �package:dplyr�:\n\n    select\ndplyr::select()\nMASS::select()"},{"path":"r-basics.html","id":"objects","chapter":"2 R Basics","heading":"2.4 Objects","text":"large part coding involve creating manipulating objects. Objects contain stuff, made first R objects previous chapter. values contained object can numbers, words, result operations analyses.assign content object using <-.","code":""},{"path":"r-basics.html","id":"activity-1-create-some-objects","chapter":"2 R Basics","heading":"2.4.1 Activity 1: Create some objects","text":"Copy paste following code console, change code uses name age run . see name, age, today, new_year, data appear environment pane.command use need help understand function rnorm()?`\nFigure 2.1: Objects environment\nNote examples, name,age, new_year always contain values emily, 35, date New Year's Day 2021, however, today draw date operating system data randomly generated set data values objects static.side note, ever teach programming statistics, use age example every time update teaching materials get reminder fragility existence advancing age. 2021 update: now given updating age, remain forever 35.Importantly, objects can involved calculations can interact . example:Finally, can store result operations new object:\nmay find helpful read <- \ncontains, e.g., name contains text\nemily.\nconstantly creating objects throughout course learn behave go along, however, now enough understand way saving values, values can numbers, text, result operations, can used operations create new variables.\nmay also see objects referred ‘variables’. \ndifference two programming terms, however, used\nsynonymously frequently.\n","code":"\nname <- \"emily\"\nage <- 16 + 19 \ntoday <- Sys.Date()\nnew_year <- as.Date(\"2022-01-01\")\ndata <- rnorm(n = 10, mean = 15, sd = 3)\nage + 10\nnew_year - today\nmean(data)## [1] 45\n## Time difference of -534 days\n## [1] 15.27983\ndecade <- age + 10"},{"path":"r-basics.html","id":"vectors","chapter":"2 R Basics","heading":"2.5 Vectors","text":"working R objects containing single element data, commonly work vectors. vector sequence elements, data type. logical, numerical, character etc.function c lets 'concatenate' link separate elements together single vector.","code":"\nnumeric_vector <- c(1,2,3)\n\ncharacter_vector <- c(\"fruits\", \"vegetables\", \"seeds\")\n\nlogical_vector <- c(TRUE, TRUE, FALSE)"},{"path":"r-basics.html","id":"dataframes-and-tibbles","chapter":"2 R Basics","heading":"2.6 Dataframes and tibbles","text":"looked R objects contain:single elements datasingle elements datamultiple elements data type - vectorsmultiple elements data type - vectorsBut often import data R put object called tibble type dataframe.\ndataframe data structure organises data table.\nDataframes can mix different types data . \ncolumn dataframe different vector, row different\nelement within vectors.\nquick go making tibble scratch.\nUse str() object vector find important\ninformation, like data type vector many elements \ncontains.\nNow put vectors together, become variables new tibble using function tibble()go messing script figure functions .","code":"\n# make some variables/ vectors\nperson <- c(\"Mark\", \"Phil\", \"Becky\", \"Tony\")\n\nhobby <- c(\"kickboxing\", \"coding\", \"dog walking\", \"car boot sales\")\n\nawesomeness <- c(1,100,1,1)\n# make a tibble\nmy_data <- tibble(person, hobby, awesomeness)\nmy_data# A tibble: 4 x 3\n  person hobby          awesomeness\n  <chr>  <chr>                <dbl>\n1 Mark   kickboxing               1\n2 Phil   coding                 100\n3 Becky  dog walking              1\n4 Tony   car boot sales           1\n# Some R functions for looking at tibbles and dataframes\n\nhead(my_data, n=2)\ntail(my_data, n=1)\nnrow(my_data)\nncol(my_data)\ncolnames(my_data)\nview(my_data)\nglimpse(my_data)\nstr(my_data)"},{"path":"r-basics.html","id":"organising-data-in-wide-and-long-formats","chapter":"2 R Basics","heading":"2.7 Organising data in wide and long formats","text":"two main conventions dataframes R, wide long formats.wide data format repeat values first column, data relating \"measured thing\" found different columnsA wide data format repeat values first column, data relating \"measured thing\" found different columnsA long data format different column type thing measures data. variable unique column.long data format different column type thing measures data. variable unique column.\nFigure 2.2: visual representation long wide format data shapes\nneither wide long data correct , work long data clearer many distinct types variables data tools using tidyverse designed work long data.","code":""},{"path":"r-basics.html","id":"using-pivot-functions","chapter":"2 R Basics","heading":"2.8 Using pivot functions","text":"functions found part tidyverse can help us reshape data.tidyr::pivot_wider() - long wide formattidyr::pivot_wider() - long wide formattidyr::pivot_longer() - wide long formattidyr::pivot_longer() - wide long format\nFigure 2.3: Reshaping data pivot\nsave changes data format, must assign object, two optionsUse name original R object, overwrite original new formatUse name original R object, overwrite original new formatUse new name reformatted data R objects exist EnvironmentUse new name reformatted data R objects exist EnvironmentNeither correct aware .","code":"\n country <- c(\"x\", \"y\", \"z\")\n yr1960 <-  c(10, 20, 30)\n yr1970 <-  c(13, 23, 33)\n yr2010 <-  c(15, 25, 35)\n\ncountry_data <- tibble(country, yr1960, yr1970, yr2010)\ncountry_data\npivot_longer(data = country_data,\n             cols = yr1960:yr2010,\n             names_to = \"year\",\n             names_prefix = \"yr\",\n             values_to = \"metric\")"},{"path":"r-basics.html","id":"overwrite-the-original-object","chapter":"2 R Basics","heading":"2.8.1 Overwrite the original object","text":"","code":"\ncountry_data <- pivot_longer(data = country_data,\n             cols = yr1960:yr2010,\n             names_to = \"year\",\n             names_prefix = \"yr\",\n             values_to = \"metric\")"},{"path":"r-basics.html","id":"create-a-new-r-object","chapter":"2 R Basics","heading":"2.8.2 Create a new r object","text":"","code":"\nlong_country_data <- pivot_longer(data = country_data,\n             cols = yr1960:yr2010,\n             names_to = \"year\",\n             names_prefix = \"yr\",\n             values_to = \"metric\")"},{"path":"r-basics.html","id":"looking-after-the-environment","chapter":"2 R Basics","heading":"2.9 Looking after the environment","text":"writing lot code may find environment pane (workspace) become cluttered many objects. can make difficult figure object need therefore run risk using wrong data frame. working new dataset, tried lots different code getting final version, good practice remember clear environment avoid using wrong object. can several way.remove individual objects, can type rm(object_name) console. Try now remove one objects created previous section.clear objects environment run rm(list = ls()) console.clear objects environment can also click broom icon environment pane.\nFigure 2.4: Clearing workspace\n","code":""},{"path":"r-basics.html","id":"global-options","chapter":"2 R Basics","heading":"2.10 Global options","text":"default, open R Studio show last working , including code objects created. might sound helpful, actually tends cause problems worth means risk accidentally using old version object. recommend changing settings time start R Studio, opens fresh copy. can clicking Tools - Global Options deselecting boxes looks like .\nFigure 2.5: Set options increase reproducibility\nRestore .RData workspace startup checkeduncheckedSave workspace .RData exit AlwaysNeverAsk","code":""},{"path":"r-basics.html","id":"r-sessions","chapter":"2 R Basics","heading":"2.11 R sessions","text":"open R start writing code, loading packages, creating objects, new session. addition clearing workspace, can sometimes useful start new session. happen automatically time start R computer, although sessions can persist cloud. find code working figure , might worth starting new session. clear environment detach loaded packages - think like restarting phone.","code":""},{"path":"r-basics.html","id":"activity-2","chapter":"2 R Basics","heading":"2.12 Activity 2","text":"Click 'Session - Restart R'.tried turning ? vital restart R regularly. Restarting R helps avoid accidentally using wrong data functions stored environment. Restarting R takes second several times per day! get used saving everything script, ’ll always happy restart R. help develop robust reproducible data analysis skills.\nFigure 2.6: truth programming\n\nmean can’t shouldn’t ever save work \n.RData/.rda files.\n\nbest consciously load exactly want \nload. Letting R silently save load everything may also\ninclude broken data objects.\n","code":""},{"path":"r-basics.html","id":"how-to-cite-r-and-rstudio","chapter":"2 R Basics","heading":"2.13 How to cite R and RStudio","text":"may way writing scientific report cite reference R, however, time comes important people built (free!) credit. provide separate citations R, RStudio, packages use.get citation version R using, simply run citation() function always provide recent citation.generate citation packages using, can also use citation() function name package wish cite.generate citation version RStudio using, can use RStudio.Version() function:Finally, example might look write-method section:Analysis conducted using R ver 4.0.0 (R Core Team, 2020), RStudio (Rstudio Team, 2020), tidyverse range packages (Wickham, 2017).noted, may , come back important give open-source community credit work.","code":"\ncitation()## To cite R in publications use:\n## \n##   R Core Team (2023). _R: A Language and Environment for Statistical\n##   Computing_. R Foundation for Statistical Computing, Vienna, Austria.\n##   <https://www.R-project.org/>.\n## \n## A BibTeX entry for LaTeX users is\n## \n##   @Manual{,\n##     title = {R: A Language and Environment for Statistical Computing},\n##     author = {{R Core Team}},\n##     organization = {R Foundation for Statistical Computing},\n##     address = {Vienna, Austria},\n##     year = {2023},\n##     url = {https://www.R-project.org/},\n##   }\n## \n## We have invested a lot of time and effort in creating R, please cite it\n## when using it for data analysis. See also 'citation(\"pkgname\")' for\n## citing R packages.\ncitation(\"tidyverse\")## To cite package 'tidyverse' in publications use:\n## \n##   Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R,\n##   Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller\n##   E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V,\n##   Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). \"Welcome to\n##   the tidyverse.\" _Journal of Open Source Software_, *4*(43), 1686.\n##   doi:10.21105/joss.01686 <https://doi.org/10.21105/joss.01686>.\n## \n## A BibTeX entry for LaTeX users is\n## \n##   @Article{,\n##     title = {Welcome to the {tidyverse}},\n##     author = {Hadley Wickham and Mara Averick and Jennifer Bryan and Winston Chang and Lucy D'Agostino McGowan and Romain François and Garrett Grolemund and Alex Hayes and Lionel Henry and Jim Hester and Max Kuhn and Thomas Lin Pedersen and Evan Miller and Stephan Milton Bache and Kirill Müller and Jeroen Ooms and David Robinson and Dana Paige Seidel and Vitalie Spinu and Kohske Takahashi and Davis Vaughan and Claus Wilke and Kara Woo and Hiroaki Yutani},\n##     year = {2019},\n##     journal = {Journal of Open Source Software},\n##     volume = {4},\n##     number = {43},\n##     pages = {1686},\n##     doi = {10.21105/joss.01686},\n##   }\nRStudio.Version()"},{"path":"r-basics.html","id":"help-and-additional-resources","chapter":"2 R Basics","heading":"2.14 Help and additional resources","text":"\nFigure 2.7: truth programming\nGetting good programming really means getting good trying stuff , searching help online, finding examples code copy. difficulty exercises contained book can ask help Teams, however, learning problem-solve effectively key skill need develop throughout course.Use help documentation. struggling understand function works, remember ?function help() command.Use help documentation. struggling understand function works, remember ?function help() command.get error message, copy paste Google - likely someone else problem.get error message, copy paste Google - likely someone else problem.struggling produce particular output process - try organising google searches include key terms \"R\" \"tidyverse\". - e.g. \"change character strings NA values tidyverse\"struggling produce particular output process - try organising google searches include key terms \"R\" \"tidyverse\". - e.g. \"change character strings NA values tidyverse\"official Cheatsheets great resource keep bookmarked.official Cheatsheets great resource keep bookmarked.Remember ask helpRemember ask helpIn addition course materials number excellent resources learning R:\nStackOverflow\nR Data Science\nSearch use #rstats hashtag Twitter\naddition course materials number excellent resources learning R:StackOverflowR Data ScienceSearch use #rstats hashtag Twitter","code":""},{"path":"r-basics.html","id":"debugging-tips","chapter":"2 R Basics","heading":"2.15 Debugging tips","text":"large part coding trying figure code work true whether novice expert. progress course keep record mistakes make fixed . chapter provide number common mistakes look undoubtedly make (fix!) new mistakes .","code":""},{"path":"r-basics.html","id":"prevent-errors","chapter":"2 R Basics","heading":"2.15.1 Prevent errors","text":"Read console outputs goCheck functions producing output expectBuild complex code simple stages","code":""},{"path":"r-basics.html","id":"fix-errors","chapter":"2 R Basics","heading":"2.15.2 Fix errors","text":"loaded correct packages functions trying use? One common mistake write code load package, e.g., library(tidyverse) forget run .loaded correct packages functions trying use? One common mistake write code load package, e.g., library(tidyverse) forget run .made typo? Remember data DATA t.test t_test.made typo? Remember data DATA t.test t_test.package conflict? tried specifying package function package::function?package conflict? tried specifying package function package::function?definitely error? red text R means error - sometimes just giving message information.definitely error? red text R means error - sometimes just giving message information.","code":""},{"path":"r-basics.html","id":"activity-7-test-yourself","chapter":"2 R Basics","heading":"2.16 Activity 7: Test yourself","text":"Question 1. never include code install.packages() analysis scripts? use library() insteadPackages already part Base RYou (someone else) may accidentally install package update stops code workingYou already latest version packageRemember, run install.packages() always install latest version package overwrite older versions package may installed.Question 2. following code produce?dataset 10 numbers mean 6 SD 50A dataset 6 numbers mean 50 SD 10A dataset 50 numbers mean 10 SD 6A dataset 50 numbers mean 10 SD 6The default form rnorm() rnorm(n, mean, sd). need help remembering argument function , look help documentation running ?rnormQuestion 3. two packages functions name want specify exactly package use, code use?package::functionfunction::packagelibrary(package)install.packages(package)use form package::function, example dplyr::select. Remember first load packages R warn functions name - remember look !Question 4. following likely argument? read_csv()<-35Question 5. easy way spot functions look numbersbracketscomputers.Question 6. job <- send output function /assignmentargumentobject.Question 7. vector must always contain elements data type (e.g logical, character, numeric) FALSETRUE.Question 8. dataframe/tibble must always contain elements data type FALSETRUE","code":"\nrnorm(6, 50, 10)"},{"path":"loading-data.html","id":"loading-data","chapter":"3 Loading data","heading":"3 Loading data","text":"workshop work loading data. curated cleaned dataset can work generating insights data.biologist used asking questions gathering data. also important learn aspects research process. includes responsible data management (understanding data files & spreadsheet organisation, keeping data safe) data analysis.chapter look structure data files, read R. also continue develop reproducible scripts. means writing scripts well organised easy read, also making sure scripts complete capable reproducing analysis start finish.Transparency reproducibility key values scientific research, analyse data reproducible way means others can understand check work. also means important person can benefit work, ! return analysis even short break, thanking earlier self worked clear reproducible way, can pick right left .","code":""},{"path":"loading-data.html","id":"meet-the-penguins","chapter":"3 Loading data","heading":"3.1 Meet the Penguins","text":"data, taken palmerpenguins ((R-palmerpenguins?)) package originally published Gorman et al. (2014). course work real data shared researchers.palmer penguins data contains size measurements, clutch observations, blood isotope ratios three penguin species observed three islands Palmer Archipelago, Antarctica study period three years.data collected 2007 - 2009 Dr. Kristen Gorman Palmer Station Long Term Ecological Research Program, part US Long Term Ecological Research Network. data imported directly Environmental Data Initiative (EDI) Data Portal, available use CC0 license (“Rights Reserved”) accordance Palmer Station Data Policy. gratefully acknowledge Palmer Station LTER US LTER Network. Special thanks Marty Downs (Director, LTER Network Office) help regarding data license & use. intrepid package co-author, Dr. Gorman, action collecting penguin data:map study site","code":""},{"path":"loading-data.html","id":"activity-1-organising-our-workspace","chapter":"3 Loading data","heading":"3.2 Activity 1: Organising our workspace","text":"can begin working data, need set-.Go RStudio Cloud open Penguins R projectGo RStudio Cloud open Penguins R projectCreate following folders using + New Folder button Files tab\ndata\noutputs\nscripts\nCreate following folders using + New Folder button Files tabdataoutputsscripts\nR case-sensitive type everything EXACTLY printed \nseparate subfolders within project helps keep things tidy, means harder lose things, lets easily tell R exactly go retrieve data.next step workflow well organised project space. RStudio Cloud lot hard work , new data project can set Project space.define project series linked questions uses one (sometimes several) datasets. example coursework assignment particular module project, series linked experiments particular research project might project.Project contain several files, possibly organised sub-folders containing data, R scripts final outputs. might want keep information (wider reading) gathered relevant project.\nFigure 3.1: example typical R project set-\nWithin project notice already one file .Rproj. R project file, useful feature, interacts R tell working specific place computer (case cloud server dialed ). means R automatically treat location project file 'working directory' makes importing exporting easier1.\nimportant NEVER move .Rproj file, may\nprevent workspace opening properly.\n","code":""},{"path":"loading-data.html","id":"activity-2-access-our-data","chapter":"3 Loading data","heading":"3.3 Activity 2: Access our data","text":"Now project workspace, ready import data.Use link open page browser data openUse link open page browser data openRight-click Save download csv format computer (Make note file downloaded e.g. Downloads)Right-click Save download csv format computer (Make note file downloaded e.g. Downloads)Compare data looks \"raw\" format open data ExcelCompare data looks \"raw\" format open data ExcelAt first glance data might look quite strange messy. stored CSV comma-separated values file. CSV files plain text files can store large amounts data, can readily imported spreadsheet storage database.files simplest form database, coloured cells, formulae, text formatting. row row data, value row (previously separate columns) separated comma.file format helps us maintain ethos Keep Raw Data Raw -many cases, captured collected data may unique impossible reproduce, measurements lab field observations. reason, protected possible loss. Every time change made raw data file threatens integrity information.practice, means use data file data entry storage. data manipulation, cleaning analysis happens R, using transparent reproducible scripts.\navoid saving files Excel format nasty\nhabit formatting even losing data file gets large\nenough.\n\n[https://www.theguardian.com/politics/2020/oct/05/-excel-may--caused-loss--16000-covid-tests--england].\n\nneed add data csv file, can always open \nExcel-like program add information, remember save \noriginal csv format afterwards.\n\nFigure 3.2: Top image: Penguins data viewed Excel, Bottom image: Penguins data native csv format\nraw format, line CSV separated commas different values. open spreadsheet program like Excel automatically converts comma-separated values tables columns.\nprobably used working Excel (.xls .xlsx)\nfile formats, widely supported, CSV files, simple\ntext formats supported data interfaces. also \nproprietary (e.g. Excel format owned Microsoft), working\n.csv format data open accessible.\n","code":""},{"path":"loading-data.html","id":"activity-3-upload-our-data","chapter":"3 Loading data","heading":"3.4 Activity 3: Upload our data","text":"data now Downloads folder computerThe data now Downloads folder computerWe need upload data remote cloud-server (RStudio Cloud), select upload files server button Files tabWe need upload data remote cloud-server (RStudio Cloud), select upload files server button Files tabPut file data folder - make mistake select tickbox file, go cogs button choose option Move.Put file data folder - make mistake select tickbox file, go cogs button choose option Move.\nFigure 3.3: Highlighted buttons upload files, options\n","code":""},{"path":"loading-data.html","id":"activity-4-make-a-script","chapter":"3 Loading data","heading":"3.5 Activity 4: Make a script","text":"now create new R script file write instructions store comments manipulating data, developing tables figures. Use File > New Script menu item select R Script.Add following:load following add-package R script, just underneath comments. Tidyverse actually one package, bundle many different packages play well together - example includes ggplot2 used last session, call separatelyAdd following script:Save file inside scripts folder call 01_import_penguins_data.R\nClick document outline button (top right script pane). \nshow use \n\n#TITLES—-\n\nAllows us build series headers subheaders, \nuseful using longer scripts.\n","code":"\n#___________________________----\n# SET UP ----\n## An analysis of the bill dimensions of male and female Adelie, Gentoo and Chinstrap penguins ----\n\n### Data first published in  Gorman, KB, TD Williams, and WR Fraser. 2014. “Ecological Sexual Dimorphism and Environmental Variability Within a Community of Antarctic Penguins (Genus Pygoscelis).” PLos One 9 (3): e90081. https://doi.org/10.1371/journal.pone.0090081. ----\n#__________________________----\n# PACKAGES ----\nlibrary(tidyverse) # tidy data packages\nlibrary(janitor) # cleans variable names\nlibrary(lubridate) # make sure dates are processed properly\n#__________________________----"},{"path":"loading-data.html","id":"activity-5-read-in-data","chapter":"3 Loading data","heading":"3.6 Activity 5: Read in data","text":"Now can read data. use function readr::read_csv() allows us read .csv files. also functions allow read .xlsx files formats, however course use .csv files.First, create object called penguins_data contains data penguins_raw.csv file.First, create object called penguins_data contains data penguins_raw.csv file.Add following script, check document outline:Add following script, check document outline:\nalso function called read.csv(). \ncareful use function instead read_csv() \ndifferent ways naming columns.\n","code":"\n# IMPORT DATA ----\npenguins <- read_csv (\"data/penguins_raw.csv\")\n\nhead(penguins) # check the data has loaded, prints first 10 rows of dataframe\n#__________________________----"},{"path":"loading-data.html","id":"filepaths","chapter":"3 Loading data","heading":"3.7 Filepaths","text":"example read_csv() function requires provide filepath (\"quotes\"), order tell R file wish read located example two components\"data/\" - specifies directory look file\"data/\" - specifies directory look file\"penguins_raw.csv\" - specifies name format file\"penguins_raw.csv\" - specifies name format file","code":""},{"path":"loading-data.html","id":"directories","chapter":"3 Loading data","heading":"3.7.1 Directories","text":"directory refers folder computer relationships folders. term “directory” considers relationship folder folders within around . Directories hierarchical means can exist within folders well folders exist within .\nidea directories files ? alone File\nFound\n\"parent\" directory folder contains subdirectory. example downloads folder directory, parent directory subdirectories files contained within .","code":""},{"path":"loading-data.html","id":"home-directory","chapter":"3 Loading data","heading":"3.7.2 Home directory","text":"home directory computer directory defined operating system. home directory primary directory user account computer. files default stored home directory.Windows, home directory typically C:\\Users\\-username.Windows, home directory typically C:\\Users\\-username.Mac Linux, home directory typically /home/-username.Mac Linux, home directory typically /home/-username.","code":""},{"path":"loading-data.html","id":"working-directory","chapter":"3 Loading data","heading":"3.7.3 Working directory","text":"working directory refers directory computer tool assumes starting place filepaths","code":""},{"path":"loading-data.html","id":"absolute-vs-relative-filepaths","chapter":"3 Loading data","heading":"3.7.4 Absolute vs Relative filepaths","text":"got working R?use programming language, specify filepaths order program find files read-output files.Absolute file path path contains entire path file directory starting Home directory ending file directory wish access e.g./home/-username/project/data/penguins_raw.csvThe main drawbacks using absolute file paths :share files, another user won’t directory structure , need recreate file pathsIf share files, another user won’t directory structure , need recreate file pathsif alter directory structure, ’ll need rewrite pathsif alter directory structure, ’ll need rewrite pathsan absolute file path likely longer relative path, backslashes need edited, scope error.absolute file path likely longer relative path, backslashes need edited, scope error.different computers can different path constructions, scripts use absolute filepaths reproducible.Relative filepath path relative working directory location computer.use RStudio Projects, wherever .Rproj file located set working directory. means .Rproj file located project folder relative path data :data/penguins_raw.csvThis filepath shorter means share project someone else script run without editing.\nusing RStudio Cloud, remember working \nLinux OS cloud server, different absolute\nfilepath - scripts project working right now\nwork using relative filepaths\n","code":""},{"path":"loading-data.html","id":"activity-5-check-your-script","chapter":"3 Loading data","heading":"3.8 Activity 5: Check your script","text":"","code":"\n#___________________________----\n# SET UP ----\n## An analysis of the bill dimensions of male and female Adelie, Gentoo and Chinstrap penguins ----\n\n### Data first published in  Gorman, KB, TD Williams, and WR Fraser. 2014. “Ecological Sexual Dimorphism and Environmental Variability Within a Community of Antarctic Penguins (Genus Pygoscelis).” PLos One 9 (3): e90081. https://doi.org/10.1371/journal.pone.0090081. ----\n#__________________________----\n\n# PACKAGES ----\nlibrary(tidyverse) # tidy data packages\nlibrary(janitor) # cleans variable names\nlibrary(lubridate) # make sure dates are processed properly\n#__________________________----\n\n# IMPORT DATA ----\npenguins <- read_csv (\"data/penguins_raw.csv\")\n\nhead(penguins) # check the data has loaded, prints first 10 rows of dataframe\n#__________________________----"},{"path":"loading-data.html","id":"activity-7-test-yourself-1","chapter":"3 Loading data","heading":"3.9 Activity 7: Test yourself","text":"Question 1. order make R project reproducible filepath use?Absolute filepathRelative filepathQuestion 2. acceptable include raw datafile?Highlighting blocks cellsExcel formulaeA column observational notes fielda mix ddmmyy yymmdd date formatsQuestion 3. always first set functions script? ?()Question 4. reading data R useread_csv()read.csv()Question 5. format penguins data ?wide datalong dataEach column unique variable row unique observation data long (tidy) formatQuestion 6. working directory projects default set location ?data filesthe .Rproj fileyour R scriptQuestion 7. Using filepath \"data/penguins_raw.csv\" example ofan absolute filepatha relative filepathQuestion 8. operator need use wish assign output read_csv function R object (rather just print dataframe console)?","code":""},{"path":"foundations-of-mixed-modelling.html","id":"foundations-of-mixed-modelling","chapter":"4 Foundations of Mixed Modelling","heading":"4 Foundations of Mixed Modelling","text":"","code":""},{"path":"foundations-of-mixed-modelling.html","id":"what-is-a-mixed-model","chapter":"4 Foundations of Mixed Modelling","heading":"4.1 What is a mixed model?","text":"Mixed models (also known linear mixed models hierarchical linear models) statistical tests build simpler tests regression, t-tests ANOVA. tests special cases general linear model; fit straight line data explain variance systematic way.key difference linear mixed-effects model inclusion random effects - variables observations grouped subcategories systematically affect outcome - account important structure data.mixed-effects model can used many situations instead one straightforward tests structure may important. main advantages approach :mixed-effects models account variancemixed-effects models incorporate group even individual-level differencesmixed-effects models cope well missing data, unequal group sizes repeated measurements","code":""},{"path":"foundations-of-mixed-modelling.html","id":"fixed-vs-random-effects","chapter":"4 Foundations of Mixed Modelling","heading":"4.2 Fixed vs Random effects","text":"Explain difference fixed random effects\nDiscuss hierarchical structure data need mixed models\nProvide overview linear mixed model equation\nTouch assumptions mixed models","code":""},{"path":"foundations-of-mixed-modelling.html","id":"fixed-effects","chapter":"4 Foundations of Mixed Modelling","heading":"4.2.1 Fixed effects","text":"broad terms, fixed effects variables expect affect dependent/response variable: ’re call explanatory variables standard linear regression.EXAMPLES:Fixed effects common random effects, least use (reality). Fixed effects estimate different levels relationship assumed levels. example, model fixed effect fish sex, get estimate males estimate females separately. assumed relationship two levels. means infer happens levels even may obvious. Fixed effects also assume common variance known homoscedasticity. find reason differ, post hoc adjustments needed make pairwise comparisons different factor levels.Another example fixed effect thinking fixed effect treatment drug health response. predictor drug may fixed factor 4 levels, representing 4 different drugs—placebo, Drug , Drug B, Drug C. case, might design experiment analyzed ANOVA. test effect different drug levels, want independent —meaning effect Drug compared Drug B include information two groups. don’t want information even assumption non-independence infiltrate groups want compare. ,Fixed effects default effects learn begin understand statistical concepts, fixed effects default effects functions like lm() aov().","code":""},{"path":"foundations-of-mixed-modelling.html","id":"random-effects","chapter":"4 Foundations of Mixed Modelling","heading":"4.2.2 Random effects","text":"Random effects less commonly used perhaps widely encountered nature. level can considered random variable underlying process distribution random effect.hand, random effects usually grouping factors trying control. always categorical, can’t force R treat continuous variable random effect. lot time specifically interested impact response variable, know might influencing patterns see.Additionally, data random effect just sample possibilities: unlimited time funding might sampled every mountain dragons live, every school country, every chocolate box), usually tend generalise results whole population based representative sampling. don’t care estimating much better pupils school done compared pupils school B, know respective teachers might reason scores different, ’d like know much variation attributable predict scores pupils school Z.\nbook Data analysis using regression \nmultilevel/hierarchical models (Gelman Hill 2006). authors\nexamined five definitions fixed random effects found \ndefinition completely fit circumstances. Thus turns \nfixed random effects born made. make decision \ntreat variable fixed random particular analysis.\ntrying ? trying make predictions ? just variation (.k.“noise”) need control ?\nrandom effects:\n\nNote golden rule generally want random\neffect least five levels. , instance, wanted \ncontrol effects dragon’s sex intelligence, fit\nsex (two level factor: male female) fixed, random,\neffect.\n\n, put simply, estimating variance data points\nimprecise. Mathematically , wouldn’t lot\nconfidence . two three levels, model\nstruggle partition variance - give output,\nnecessarily one can trust.\n\nFinally, keep mind name random doesn’t much \nmathematical randomness. Yes, ’s confusing. Just think \ngrouping variables now. Strictly speaking ’s \nmaking models representative questions getting better\nestimates. Hopefully, next examples help make sense \n’re used.\n\n’s firm rule minimum number factor levels\nrandom effect really can use factor \ntwo levels. However commonly reported may want\nfive factor levels random effect order really\nbenefit random effect can . Another case \nmay want random effect don’t want factor levels\ninform don’t assume factor levels come\ncommon distribution. noted , male female \nfactor two levels oftentimes want male female\ninformation estimated separately ’re necessarily assuming \nmales females come population sexes \ninfinite number ’re interested average.\n","code":""},{"path":"foundations-of-mixed-modelling.html","id":"why-use-mixed-models","chapter":"4 Foundations of Mixed Modelling","heading":"4.3 Why use mixed models?","text":"","code":""},{"path":"foundations-of-mixed-modelling.html","id":"all-in-one-model","chapter":"4 Foundations of Mixed Modelling","heading":"4.3.1 All in one model","text":"Briefly introduce mixed models applications\nHighlight benefits incorporating random effects partial poolingOne way analyse data fit linear model data, ignoring groups now.\nFigure 4.1: Linear model conducted data\n\nFigure 4.2: Linear model conducted data\n","code":"\ndata <- expand.grid(group = as.factor(seq(1:10)), \n                    obs = as.factor(seq(1:100))) %>%\n  left_join(rand_eff,\n            by = \"group\") %>%\n  mutate(x = runif(n = nrow(.), 0, 10),\n         B0 = 20,\n         B1 = 2,\n         E = rnorm(n = nrow(.), 0, 10)) %>%\n  mutate(y = B0 + b0 + x * (B1 + b1) + E)\n\ndata <- expand.grid(group = as.factor(seq(1:4)), \n                    obs = as.factor(seq(1:100)))\n\ndata.1 <- expand.grid(group = as.factor(5),\n          obs = as.factor(seq(1:30)))\n\ndata <- bind_rows(data, data.1) %>% \n  left_join(rand_eff,\n            by = \"group\") %>%\n  mutate(x = runif(n = nrow(.), 0, 10),\n         B0 = 20,\n         B1 = 2,\n         E = rnorm(n = nrow(.), 0, 10)) %>%\n  mutate(y = B0 + b0 + x * (B1 + b1) + E)\nbasic_model <- lm(y ~ x, data = data)\nsummary(basic_model)## \n## Call:\n## lm(formula = y ~ x, data = data)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -59.977 -14.879  -2.868  12.451  68.365 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  18.5825     1.4005   13.27   <2e-16 ***\n## x             2.7647     0.2461   11.24   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 22.12 on 998 degrees of freedom\n## Multiple R-squared:  0.1123, Adjusted R-squared:  0.1114 \n## F-statistic: 126.2 on 1 and 998 DF,  p-value: < 2.2e-16\nplot(data$x, data$y)\nggplot(data, aes(x = x, \n                 y = y)) +\n  geom_point() +\n  labs(x = \"Independent Variable\", \n       y = \"Dependent Variable\")+\n  geom_smooth(method = \"lm\")\nperformance::check_model(basic_model)\nggplot(data, aes(x = group, \n                 y = y)) +\n  geom_boxplot() +\n  labs(x = \"Groups\", \n       y = \"Dependent Variable\")\n# Color tagged by group\nplot_group <- ggplot(data, aes(x = x, \n                               y = y, \n                               color = group,\n                               group = group)) +\n  geom_point(alpha = 0.6) +\n  labs(title = \"Data Coloured by Group\", \n       x = \"Independent Variable\", \n       y = \"Dependent Variable\")+\n  theme(legend.position=\"none\")\n\nplot_group"},{"path":"foundations-of-mixed-modelling.html","id":"additive-model","chapter":"4 Foundations of Mixed Modelling","heading":"4.3.2 Additive model","text":"","code":"\nadditive_model <- lm(y ~ x*group, data = data)\n\nsummary(additive_model)## \n## Call:\n## lm(formula = y ~ x * group, data = data)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -30.398  -6.981   0.214   6.573  33.222 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)   8.50303    2.07036   4.107 4.34e-05 ***\n## x             2.88870    0.34313   8.419  < 2e-16 ***\n## group2        4.53108    2.85059   1.590   0.1123    \n## group3       42.46669    3.02009  14.061  < 2e-16 ***\n## group4       13.82819    2.88476   4.794 1.89e-06 ***\n## group5       13.67873    2.93845   4.655 3.68e-06 ***\n## group6       46.93984    3.07871  15.247  < 2e-16 ***\n## group7       20.70395    2.89106   7.161 1.57e-12 ***\n## group8      -10.91396    2.70002  -4.042 5.71e-05 ***\n## group9       -2.23045    2.84238  -0.785   0.4328    \n## group10       2.49895    2.89232   0.864   0.3878    \n## x:group2     -0.43132    0.49197  -0.877   0.3809    \n## x:group3     -0.41197    0.50727  -0.812   0.4169    \n## x:group4     -1.03306    0.49067  -2.105   0.0355 *  \n## x:group5     -1.09588    0.50402  -2.174   0.0299 *  \n## x:group6     -0.06171    0.51200  -0.121   0.9041    \n## x:group7     -0.82995    0.48734  -1.703   0.0889 .  \n## x:group8     -2.52336    0.48572  -5.195 2.49e-07 ***\n## x:group9     -0.53117    0.49785  -1.067   0.2863    \n## x:group10    -0.95131    0.49205  -1.933   0.0535 .  \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 10.06 on 980 degrees of freedom\n## Multiple R-squared:  0.8197, Adjusted R-squared:  0.8162 \n## F-statistic: 234.5 on 19 and 980 DF,  p-value: < 2.2e-16"},{"path":"foundations-of-mixed-modelling.html","id":"multiple-analysis-approach","chapter":"4 Foundations of Mixed Modelling","heading":"4.3.3 Multiple analysis approach","text":"\nFigure 4.3: Multiple independent analyses\n","code":"\nplot_group+\n  geom_smooth(method =\"lm\")+\n  facet_wrap(~group)\nnested_data <- data %>% \n  group_by(group) %>% \n  nest()\n\nmodels <- map(nested_data$data, ~ lm(y ~ x, data = .)) %>% \n          map(broom::tidy)\n\nbind_rows(models) %>% \n  filter(term == \"x\") %>% \n  rowid_to_column(\"group\") %>% \n  mutate(p.value = report_p(p.value))"},{"path":"foundations-of-mixed-modelling.html","id":"our-first-mixed-model","chapter":"4 Foundations of Mixed Modelling","heading":"4.4 Our first mixed model","text":"mixed model good choice : allow us use data (higher sample size) account correlations data coming groups. also estimate fewer parameters avoid problems multiple comparisons encounter using separate regressions.can now join random effect matrix full dataset define y values \\[yi = B0i + b0j + B1xi + b1xj + ε\\].response variable, attempting explain part variation test score fitting independent variable fixed effect. response variable residual variation (.e. unexplained variation) associated group. using random effects, modeling unexplained variation variance.now want know association y ~ x exists controlling variation group.","code":""},{"path":"foundations-of-mixed-modelling.html","id":"running-mixed-effects-models-with-lmertest","chapter":"4 Foundations of Mixed Modelling","heading":"4.4.1 Running mixed effects models with lmerTest","text":"section detail run mixed models lmer function R package lmerTest (Kuznetsova et al. (2020)). builds older lme4 (Bates et al. (2023)) package, particular add p-values previously included. R packages can used run mixed-effects models including nlme package (Pinheiro et al. (2023)) glmmTMB package (Brooks et al. (2023)). Outside R also packages software capable running mixed-effects models, though arguably none better supported R software.groups clearly explain lot varianceSo differences groups explain ~80% variance ’s “left ” variance explained fixed effects.","code":"\n# random intercept model\nmixed_model <- lmer(y ~ x + (1|group), data = data)\n\nsummary(mixed_model)## Linear mixed model fit by REML. t-tests use Satterthwaite's method [\n## lmerModLmerTest]\n## Formula: y ~ x + (1 | group)\n##    Data: data\n## \n## REML criterion at convergence: 3224.4\n## \n## Scaled residuals: \n##      Min       1Q   Median       3Q      Max \n## -2.61968 -0.63654 -0.03584  0.66113  3.13597 \n## \n## Random effects:\n##  Groups   Name        Variance Std.Dev.\n##  group    (Intercept) 205      14.32   \n##  Residual             101      10.05   \n## Number of obs: 430, groups:  group, 5\n## \n## Fixed effects:\n##             Estimate Std. Error       df t value Pr(>|t|)    \n## (Intercept)  23.2692     6.4818   4.1570    3.59   0.0215 *  \n## x             2.0271     0.1703 424.0815   11.90   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Correlation of Fixed Effects:\n##   (Intr)\n## x -0.131\n244.5/(244.5 + 100.9) = 0.707 / 70.7%\n"},{"path":"foundations-of-mixed-modelling.html","id":"partial-pooling","chapter":"4 Foundations of Mixed Modelling","heading":"4.4.2 Partial pooling","text":"worth noting random effect estimates function group-level information overall (grand) mean random effect. Group levels low sample size poor information (.e., strong relationship) strongly influenced grand mean, adds information otherwise poorly-estimated group. However, group large sample size strong information (.e., strong relationship) little influence grand mean largely reflect information contained entirely within group. process called partial pooling (opposed pooling, effect considered, total pooling, separate models run different groups). Partial pooling results phenomenon known shrinkage, refers group-level estimates shrunk toward mean. mean? use random effect, prepared factor levels influence overall mean levels. good, clear signal group, won’t see much impact overall mean, small groups without much signal.COMPARE MODELS","code":"\npooled <- basic_model %>% \n  broom::tidy() %>% \n  mutate(Approach = \"Pooled\", .before = 1) %>% \n  select(term, estimate, std.error, Approach)\n\nno_pool <- additive_model %>% \n  broom::tidy() %>% \n  mutate(Approach = \"No Pool\", .before = 1) %>% \n  select(term, estimate, std.error, Approach)\n\npartial_pool <- mixed_model %>% \n  broom.mixed::tidy() %>% \n  mutate(Approach = \"Partial Pool\", .before = 1) %>% \n  select(Approach, term, estimate, std.error)\n\nbind_rows(pooled, no_pool, partial_pool) %>% \n  filter(term %in% c(\"x\" , \"(Intercept)\") )"},{"path":"foundations-of-mixed-modelling.html","id":"plotting-model-predictions","chapter":"4 Foundations of Mixed Modelling","heading":"4.4.3 Plotting model predictions","text":"","code":"\nbasic_pred <- emmeans(basic_model, specs = ~  x, at = list(x = c(0, 2.5, 5, 7.5, 10))) %>% as_tibble()\n\nmixed_pred <- emmeans(mixed_model, specs = ~  x, at = list(x = c(0, 2.5, 5, 7.5, 10))) %>% as_tibble()\n\npooled_plot <- data %>%\n  ggplot(aes(x = x, y = y)) +\n  geom_point(pch = 16, alpha = 0.6, aes(col = group)) +\n  geom_line(aes(x = x, y = emmean), linewidth = 1, data = basic_pred) +\n  geom_line(aes(x = x, y = lower.CL), linewidth = 0.5, linetype = 2, col = \"gray50\", data = basic_pred) +\n  geom_line(aes(x = x, y = upper.CL), linewidth = 0.5, linetype = 2, col = \"gray50\", data = basic_pred) +\n  coord_cartesian(ylim = c(0, 70))+\n  labs(title = \"Pooled model\",\n       x = \"Independent Variable\", \n       y = \"Dependent Variable\") +\n  theme(legend.position = \"none\")\n\npartial_plot <- data %>%\n  ggplot(aes(x = x, y = y)) +\n  geom_point(pch = 16, alpha = 0.6, aes(col = group)) +\n  geom_line(aes(x = x, y = emmean), linewidth = 1, data = basic_pred) +\n  geom_line(aes(x = x, y = lower.CL), linewidth = 0.5, linetype = 2, col = \"gray50\", data = mixed_pred) +\n  geom_line(aes(x = x, y = upper.CL), linewidth = 0.5, linetype = 2, col = \"gray50\", data = mixed_pred) +\n  coord_cartesian(ylim = c(0, 70))+\n  labs(title = \"Mixed model\",\n       x = \"Independent Variable\", \n       y = \"Dependent Variable\") +\n  theme(legend.position = \"none\")\n\npooled_plot /\n  partial_plot"},{"path":"foundations-of-mixed-modelling.html","id":"ggeffects","chapter":"4 Foundations of Mixed Modelling","heading":"4.5 ggeffects","text":"","code":""},{"path":"foundations-of-mixed-modelling.html","id":"sjplot","chapter":"4 Foundations of Mixed Modelling","heading":"4.6 sjPlot","text":"SHRINKAGE!BLUP - Hector book!http://optimumsportsperformance.com/blog/making-predictions---mixed-model-using-r/","code":"\ncoef(mixed_model)\n\nfixef(mixed_model)## $group\n##   (Intercept)        x\n## 1    11.82356 2.027066\n## 2    15.68146 2.027066\n## 3    47.94678 2.027066\n## 4    21.01028 2.027066\n## 5    19.88385 2.027066\n## \n## attr(,\"class\")\n## [1] \"coef.mer\"\n## (Intercept)           x \n##   23.269187    2.027066\nplot_model(mixed_model,type=\"pred\",\n           terms=c(\"x\", \"group\"),\n           pred.type=\"re\",\n           show.data = T)+\n  facet_wrap( ~ group)\n###\n\ndata1 <- data %>% \n  mutate(fit.m = predict(mixed_model, re.form = NA),\n         fit.c = predict(mixed_model, re.form = NULL))\n\ndata1 %>% \n  ggplot(aes(x = x, y = y, colour = group)) +\n    geom_point(pch = 16) + \n  geom_line(aes(y = fit.c))+ \n  geom_line(aes(y = fit.m), colour = \"grey\",\n            linetype = \"dashed\")+\n  facet_wrap( ~ group)\nplot_model(mixed_model, terms = c(\"x\", \"group\"), type = \"re\")\nplot_model(mixed_model, terms = c(\"x\", \"group\"), type = \"est\")"},{"path":"foundations-of-mixed-modelling.html","id":"checking-models","chapter":"4 Foundations of Mixed Modelling","heading":"4.7 Checking models","text":"\nFigure 4.4: Marginal fit, heavy black line random effect model histogram distribution conditional intercepts\nre.form = NA: re.form set NA, indicates random effects ignored prediction. means prediction based solely fixed effects model, ignoring variation introduced random effects. useful interested estimating overall trend relationship described fixed effects, without considering specific random effects individual groups levels.re.form = NULL: Conversely, re.form set NULL, indicates random effects included prediction. means prediction take account fixed effects random effects associated levels random effect variable. model use estimated random effects generate predictions account variation introduced random effects. useful want visualize analyze variation response variable explained different levels random effect.\nlot data, even minimal deviations \nexpected distribution become significant (discussed \nhelp/vignette DHARMa package). need assess \ndistribution decide important .\n","code":"\nplot(mixed_model) \nqqnorm(resid(mixed_model))\nqqline(resid(mixed_model)) \nrand_dist <- as.data.frame(ranef(mixed_model)) %>% \n  mutate(group = grp,\n         b0_hat = condval,\n         intercept_cond = b0_hat + summary(mixed_model)$coef[1,1],\n         .keep = \"none\")\n\nhist(rand_dist$b0_hat)\ndata1 %>%\n  ggplot(aes(x = x, y = y)) +\n  geom_point(pch = 16, col = \"grey\") +\n  geom_violinhalf(data = rand_dist, \n                  aes(x = 0, y = intercept_cond), \n                  trim = FALSE, \n                  width = 4, \n                  adjust = 2, \n                  fill = NA)+\n  geom_line(aes(y = fit.m), linewidth = 2)  +\n  coord_cartesian(ylim = c(-40, 100))+\n  labs(x = \"Independent Variable\", \n       y = \"Dependent Variable\")\nperformance::check_model(mixed_model)\nresid.mm <- DHARMa::simulateResiduals(mixed_model)\n\nplot(resid.mm)"},{"path":"foundations-of-mixed-modelling.html","id":"practice-questions","chapter":"4 Foundations of Mixed Modelling","heading":"4.8 Practice Questions","text":"","code":""},{"path":"types-of-random-effects.html","id":"types-of-random-effects","chapter":"5 Types of Random Effects","heading":"5 Types of Random Effects","text":"","code":""},{"path":"types-of-random-effects.html","id":"is-it-a-fixed-or-random-effect","chapter":"5 Types of Random Effects","heading":"5.1 Is it a fixed or random effect?","text":"BAKER BOOKMISSING DATA BAKER BOOK","code":""},{"path":"types-of-random-effects.html","id":"crossed-or-nested","chapter":"5 Types of Random Effects","heading":"5.2 Crossed or Nested","text":"common issue causes confusion issue specifying random effects either ‘crossed’ ‘nested’. reality, way specify random effects determined experimental sampling design ( Schielzeth & Nakagawa, 2013 ). simple example can illustrate difference. Imagine researcher interested understanding factors affecting clutch mass passerine bird. study population spread across five separate woodlands, containing 30 nest boxes. Every week breeding measure foraging rate females feeders, measure subsequent clutch mass. females multiple clutches season contribute multiple data points., female ID said nested within woodland : woodland contains multiple females unique woodland (never move among woodlands). nested random effect controls fact () clutches female independent, (ii) females woodland may clutch masses similar one another females woodlandsClutch Mass ∼ Foraging Rate + (1|Woodland/Female ID)Now imagine long-term study, researcher returns every year five years continue measurements. appropriate fit year crossed random effect every woodland appears multiple times every year dataset, females survive one year next also appear multiple years.Clutch Mass ∼ Foraging Rate + (1|Woodland/Female ID)+ (1|Year)Understanding whether experimental/sampling design calls nested crossed random effects always straightforward, can help visualise experimental design drawing (see Schielzeth & Nakagawa, 2013 ; Fig. 1 ), tabulating observations grouping factors (e.g. ‘ table’ command R) identify data distributed. advocate researchers always ensure levels random effect grouping variables uniquely labelled. example, females labelled 1 - n woodland, model try pool variance females code. Giving females unique code makes nested structure data implicit, model specified ∼ (1| Woodland) + (1|FemaleID) identical model .\nFigure 5.1: Fully Nested\n\nFigure 5.2: Fully Crossed\n\nFigure 5.3: Partially Nested/Crossed\n","code":""},{"path":"types-of-random-effects.html","id":"random-slopes","chapter":"5 Types of Random Effects","heading":"5.3 Random slopes","text":"","code":"\nsummary(lmer3)## Linear mixed model fit by REML ['lmerMod']\n## Formula: y ~ x + (x | group)\n##    Data: data\n## \n## REML criterion at convergence: 7519.4\n## \n## Scaled residuals: \n##     Min      1Q  Median      3Q     Max \n## -2.8846 -0.6930  0.0250  0.6579  3.3366 \n## \n## Random effects:\n##  Groups   Name        Variance Std.Dev. Corr\n##  group    (Intercept) 352.1409 18.7654      \n##           x             0.4112  0.6412  0.62\n##  Residual             101.2134 10.0605      \n## Number of obs: 1000, groups:  group, 10\n## \n## Fixed effects:\n##             Estimate Std. Error t value\n## (Intercept)  21.6680     5.9688   3.630\n## x             2.1043     0.2321   9.067\n## \n## Correlation of Fixed Effects:\n##   (Intr)\n## x 0.490\ndata.2 <- data %>% \n  mutate(fit2.m = predict(lmer3, re.form = NA),\n         fit2.c = predict(lmer3, re.form = NULL),\n         resid2 = resid(lmer3))"},{"path":"types-of-random-effects.html","id":"random-effect-correlation","chapter":"5 Types of Random Effects","heading":"5.4 Random effect correlation","text":"","code":"\nrand_dist2 <- as.data.frame(ranef(lmer3)) %>% \n  mutate(group = grp,\n          term = case_when(term == \"(Intercept)\" ~ \"b0_hat\",\n                             term == \"x\" ~ \"b1_hat\"),\n            value = condval,\n         .keep = \"none\") %>%\n  pivot_wider(id_cols = \"group\", names_from = \"term\", values_from = \"value\") %>%\n  mutate(Intercept_cond = b0_hat + summary(lmer3)$coef[1,1],\n         Slope_cond = b1_hat + summary(lmer3)$coef[2,1])\n\npmain <- rand_dist2 %>%\n  ggplot(aes(x = Intercept_cond, y = Slope_cond)) +\n    geom_point(aes(col = group), size = 3) +\n    geom_density2d(bins = 4, col = \"grey\", adjust = 3)+\n  theme(legend.position = \"none\")\n\nxdens <- ggplot()+\n  geom_density(data = rand_dist2, aes(x = Intercept_cond), fill = \"grey\", col = NA, trim = FALSE, adjust = 2) +\n  theme_void()\n\nydens <- ggplot()+\n  geom_density(data = rand_dist2, aes(x = Slope_cond), fill = \"grey\", col = NA, trim = FALSE, adjust = 2) +\n  coord_flip()+\n  theme_void()\n\nlayout <- \"\nAAA#\nBBBC\nBBBC\nBBBC\"\n\n\ninset <- xdens+pmain+ydens +plot_layout(design = layout)\n\ninset\n(plot_function(lmer1, \"Random intercept\")+coord_cartesian(\n                    ylim = c(0, 120))) + inset_element(inset, 0, 0.6, 0.4, 1)"},{"path":"types-of-random-effects.html","id":"model-refining","chapter":"5 Types of Random Effects","heading":"5.5 Model refining","text":"","code":""},{"path":"types-of-random-effects.html","id":"random-slopes-1","chapter":"5 Types of Random Effects","heading":"5.6 Random slopes","text":"random_slopes_intercept_model <- lmer(dependent_var ~ independent_var + (independent_var | group), data = data)\nrandom_slopes_values <- predict(random_slopes_model)","code":""},{"path":"types-of-random-effects.html","id":"random-intercept","chapter":"5 Types of Random Effects","heading":"5.7 Random intercept","text":"","code":""},{"path":"random-intercept-model.html","id":"random-intercept-model","chapter":"6 Random intercept model","heading":"6 Random intercept model","text":"model_intercept <- lmer(dependent_var ~ independent_var + (1 | group), data = data)\nrandom_intercept_values <- predict(model_intercept)ggplot(data, aes(x = independent_var, y = dependent_var, color = group, group = group)) +\ngeom_point(position = position_jitter(width = 0.2), alpha = 0.6) +\ngeom_line(aes(x = independent_var, y= random_intercept_values)) +\nlabs(title = \"Random Slopes\", x = \"Independent Variable\", y = \"Dependent Variable\") +\ntheme_minimal()","code":""},{"path":"biodepth-project.html","id":"biodepth-project","chapter":"7 Biodepth project","heading":"7 Biodepth project","text":"1 | Site:Mix specification, random effect specified two-way crossed random effect. means random effect varies independently combination levels Site Mix factors. : operator represents interaction crossed effect two factors. specification allows correlations random effects within combination Site Mix.hand, 1 | Site/Mix specification represents nested random effect structure. suggests random effect Mix nested within random effect Site. specification assumes levels Mix nested within level Site, meaning level Site set random effects levels Mix. / operator denotes nesting relationship.summarize:1 | Site:Mix: Two-way crossed random effect, allowing independent variation random effects combination levels Site Mix.\n1 | Site/Mix: Nested random effect, random effect Mix nested within random effect Site, assuming levels Mix nested within level Site.","code":"\nbiodepth <- biodepth %>% \n  mutate(Mix = factor(Mix),\n         Diversity2 = log(Diversity, 2)) %>% \n  drop_na()\n\n# set Mix as a factor\n# Set Diversity to log, base 2\nbio.lmer1 <- lmer(Shoot2 ~ Diversity2 + (1|Site) + (1|Block) + (1|Mix), data = biodepth)\n\nsummary(bio.lmer1)## Linear mixed model fit by REML. t-tests use Satterthwaite's method [\n## lmerModLmerTest]\n## Formula: Shoot2 ~ Diversity2 + (1 | Site) + (1 | Block) + (1 | Mix)\n##    Data: biodepth\n## \n## REML criterion at convergence: 6082.6\n## \n## Scaled residuals: \n##     Min      1Q  Median      3Q     Max \n## -2.2187 -0.5179 -0.1031  0.3941  3.1735 \n## \n## Random effects:\n##  Groups   Name        Variance Std.Dev.\n##  Mix      (Intercept) 33665.3  183.48  \n##  Block    (Intercept)   383.2   19.57  \n##  Site     (Intercept) 30163.9  173.68  \n##  Residual             22039.8  148.46  \n## Number of obs: 451, groups:  Mix, 192; Block, 15; Site, 8\n## \n## Fixed effects:\n##             Estimate Std. Error      df t value Pr(>|t|)    \n## (Intercept)  349.488     66.244   8.576   5.276 0.000598 ***\n## Diversity2    78.901     12.059 175.159   6.543 6.42e-10 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Correlation of Fixed Effects:\n##            (Intr)\n## Diversity2 -0.286\nbio.lmer2 <- lmer(Shoot2 ~ Diversity2 + (Diversity2|Site) + (1|Block) + (1|Mix), data = biodepth)\n\nsummary(bio.lmer2)## Linear mixed model fit by REML. t-tests use Satterthwaite's method [\n## lmerModLmerTest]\n## Formula: Shoot2 ~ Diversity2 + (Diversity2 | Site) + (1 | Block) + (1 |  \n##     Mix)\n##    Data: biodepth\n## \n## REML criterion at convergence: 6072.6\n## \n## Scaled residuals: \n##     Min      1Q  Median      3Q     Max \n## -2.1292 -0.5208 -0.1004  0.3739  3.2865 \n## \n## Random effects:\n##  Groups   Name        Variance Std.Dev. Corr\n##  Mix      (Intercept) 31421.7  177.26       \n##  Block    (Intercept)   391.6   19.79       \n##  Site     (Intercept) 18930.9  137.59       \n##           Diversity2   1149.9   33.91   1.00\n##  Residual             21995.1  148.31       \n## Number of obs: 451, groups:  Mix, 192; Block, 15; Site, 8\n## \n## Fixed effects:\n##             Estimate Std. Error      df t value Pr(>|t|)    \n## (Intercept)  346.070     54.362   8.734   6.366 0.000149 ***\n## Diversity2    79.181     16.855  11.289   4.698 0.000608 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Correlation of Fixed Effects:\n##            (Intr)\n## Diversity2 0.399 \n## optimizer (nloptwrap) convergence code: 0 (OK)\n## boundary (singular) fit: see help('isSingular')"},{"path":"biodepth-project.html","id":"likelihood-tests","chapter":"7 Biodepth project","heading":"7.1 Likelihood tests","text":"\nML REML\n","code":"\nbio.lmer3 <- lmer(Shoot2 ~ Diversity2 + (Diversity2|Site) + (1|Mix), data = biodepth)\n\nanova(bio.lmer2, bio.lmer3)\nnested_data <- biodepth %>% \n    group_by(Site) %>% \n    nest()\n\nmodels <- map(nested_data$data, ~ lm(Shoot2 ~ Diversity2, data = .)) %>% \n    map(predict)\nbiodepth.2 <- biodepth %>% \n    mutate(fit.m = predict(bio.lmer2, re.form = NA),\n           fit.c = predict(bio.lmer2, re.form = ~(1+Diversity2|Site)),\n           fit.l = unlist(models))\n\nbiodepth.2 %>% \n    ggplot(aes(x = Diversity2, y = Shoot2, colour = Site)) +\n    geom_point(pch = 16) + \n    geom_line(aes(y = fit.l), color = \"black\")+\n    geom_line(aes(y = fit.c))+ \n    geom_line(aes(y = fit.m), colour = \"grey\",\n              linetype = \"dashed\")+\n    facet_wrap( ~ Site)+\n   coord_cartesian(ylim = c(0, 1200))+\n   theme(legend.position = \"none\")"},{"path":"worked-examples.html","id":"worked-examples","chapter":"8 Worked Examples","heading":"8 Worked Examples","text":"https://bodowinter.com/tutorial/bw_LME_tutorial.pdf","code":"\npoliteness <- read_csv(\"files/politeness_data.csv\")\n\npoliteness.model.1 = lmer(frequency ~ gender + attitude + (1+attitude|subject) +\n                            (1+attitude|scenario),\n                        data=politeness)"},{"path":"worked-examples---dolphins.html","id":"worked-examples---dolphins","chapter":"9 Worked Examples - Dolphins","heading":"9 Worked Examples - Dolphins","text":"DOLPHIN FIXED EFFECTS","code":"\ndolphmod.1 <- lmer(vt ~ bodymass + direction + (direction|animal), data=dolphins)\ndolphmod.2 <- lmer(vt ~ bodymass + direction + (1|animal), data=dolphins)\ndolphins.1 <- dolphins %>% \n    mutate(fit.m = predict(dolphmod.2, re.form = NA),\n           fit.c = predict(dolphmod.2, re.form = NULL))\ndolphins.1 %>%\n  ggplot(aes(x = bodymass, y = vt, group = direction)) +\n  geom_point(pch = 16, aes(colour = animal)) +\n  geom_line(aes(y = fit.m, \n                linetype = direction), \n            linewidth = 1)  +\n  labs(x = \"Body Mass\", \n       y = \"VT\") \nplot_model(dolphmod.2,type=\"pred\",\n           terms=c(\"bodymass\", \"direction\"),\n           pred.type=\"fe\",\n           show.data = T)\nplot_model(dolphmod.2,type=\"pred\",\n           terms=c(\"bodymass\", \"direction\", \"animal\"),\n           pred.type=\"re\",\n           show.data = T)"},{"path":"worked-examples---dolphins.html","id":"reporting","chapter":"9 Worked Examples - Dolphins","heading":"9.1 Reporting","text":"BAKER - anova() ranova() MuMIn r.squaredGLMM","code":""},{"path":"worked-examples---dolphins.html","id":"tables","chapter":"9 Worked Examples - Dolphins","heading":"9.2 Tables","text":"","code":""},{"path":"worked-examples---dolphins.html","id":"figures","chapter":"9 Worked Examples - Dolphins","heading":"9.3 Figures","text":"","code":""},{"path":"worked-examples---dolphins.html","id":"write-ups","chapter":"9 Worked Examples - Dolphins","heading":"9.4 Write-ups","text":"","code":""},{"path":"summary.html","id":"summary","chapter":"10 Summary","heading":"10 Summary","text":"suggested workflow:Start model containing fixed effects: Begin fitting model fixed effects relevant research question. Include main predictors potential interactions hypothesize might exist. example, predictors B, might start model like response ~ + B + :B.Assess fixed effects interactions: Evaluate significance, direction, magnitude fixed effects coefficients. Look interactions show significant effects consider interpretation context research question. step allows identify key variables interactions important explaining variation response variable.Model evaluation refinement: Assess goodness fit fixed effects model using appropriate measures like AIC, BIC, model deviance. Consider conducting model comparison evaluate different models alternative fixed effects structures. process helps refine model select appropriate combination variables interactions.Incorporate random effects: identified significant fixed effects relevant interactions, can consider inclusion random effects. Random effects capture variation different levels can account individual differences clustering within groups. Evaluate need random intercepts, random slopes, crossed random effects based research design nature data.Assess compare models random effects: Fit models random effects compare fit fixed effects model. Consider appropriate measures likelihood ratio tests, AIC, BIC model comparison. Evaluate significance contribution random effects model.Validate interpret final model: Validate final model assessing assumptions, checking influential observations, performing sensitivity analysis. Interpret estimated coefficients, including fixed effects random effects, context research question. Report results, including confidence intervals p-values.initially focusing fixed effects, can establish foundation model identify significant predictors interactions. step allows better understand relationships data guide subsequent inclusion random effects appropriate.https://ademos.people.uic.edu/Chapter17.html#121_crossed__nested_designs","code":""},{"path":"summary.html","id":"mixed-model-extensions","chapter":"10 Summary","heading":"10.1 Mixed Model extensions","text":"","code":""},{"path":"summary.html","id":"practical-problems","chapter":"10 Summary","heading":"10.2 Practical problems","text":"MODEL CONVERGENCE - BAKER","code":""},{"path":"summary.html","id":"further-reading","chapter":"10 Summary","heading":"10.3 Further Reading","text":"https://peerj.com/articles/4794/https://peerj.com/articles/4794/https://link.springer.com/book/10.1007/978-0-387-87458-6https://link.springer.com/book/10.1007/978-0-387-87458-6https://peerj.com/articles/9522/https://peerj.com/articles/9522/Linear model analyses can extend beyond testing differences means categorical groupings test relationships continuous variables. known linear regression, relationship explanatory variable response variable modelled equation straight line. intercept value y x = 0, often useful, can use 'mean-centered' values wish make intercept intuitive.\nlinear models, regression assumes unexplained variability around regression line, normally distributed constant variance.regression fitted possible predict values y values x, uncertainty around predictions can captured confidence intervals.","code":""}]
